# Import des Active Directory Moduls
Import-Module ActiveDirectory

# Kanonischen Pfad der OU und die Webseite definieren
$canonicalOU = "beispiel.de/BeispielOU"
$website = "http://DerSupertester.de"

# Konvertierung des kanonischen Pfads in Distinguished Name
$ouDN = (Get-ADOrganizationalUnit -Filter "CanonicalName -eq '$canonicalOU'").DistinguishedName

# Überprüfen, ob die OU gefunden wurde
if ($ouDN -ne $null) {
    # Benutzer in der OU suchen
    $users = Get-ADUser -Filter * -SearchBase $ouDN

    # Überprüfen, ob Benutzer gefunden wurden und das wWWHomePage Attribut aktualisieren
    foreach ($user in $users) {
        Set-ADUser -Identity $user -Replace @{wWWHomePage=$website}
        Write-Host "Webseite für Benutzer [$($user.Name)] auf [$website] aktualisiert."
    }
} else {
    Write-Host "OU [$canonicalOU] nicht gefunden."
}
